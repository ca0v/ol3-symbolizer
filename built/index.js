define("ol3-symbolizer/format/base",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})}),define("ol3-symbolizer/format/ol3-symbolizer",["require","exports","openlayers"],function(e,t,l){"use strict";function i(e,t){null!=e&&t(e)}function p(t,i){return Object.keys(i).forEach(function(e){return t[e]=i[e]}),t}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.fromJson=function(e){return this.deserializeStyle(e)},e.prototype.toJson=function(e){return this.serializeStyle(e)},e.prototype.setGeometry=function(e){var t=e.getGeometry();return t instanceof l.geom.Polygon&&(t=t.getInteriorPoint()),t},e.prototype.assign=function(e,t,i){null!=i&&("object"==typeof i&&0===Object.keys(i).length||("image"===t&&(i.hasOwnProperty("radius")&&(t="circle"),i.hasOwnProperty("points")&&(t="star")),e[t]=i))},e.prototype.serializeStyle=function(t){var i=this,r={};return t?"string"==typeof t?t:"number"==typeof t?t:(t.getColor&&p(r,this.serializeColor(t.getColor())),t.getImage&&this.assign(r,"image",this.serializeStyle(t.getImage())),t.getFill&&this.assign(r,"fill",this.serializeFill(t.getFill())),t.getOpacity&&this.assign(r,"opacity",t.getOpacity()),t.getStroke&&this.assign(r,"stroke",this.serializeStyle(t.getStroke())),t.getText&&this.assign(r,"text",this.serializeStyle(t.getText())),t.getWidth&&this.assign(r,"width",t.getWidth()),t.getOffsetX&&this.assign(r,"offset-x",t.getOffsetX()),t.getOffsetY&&this.assign(r,"offset-y",t.getOffsetY()),t.getWidth&&this.assign(r,"width",t.getWidth()),t.getFont&&this.assign(r,"font",t.getFont()),t.getRadius&&this.assign(r,"radius",t.getRadius()),t.getRadius2&&this.assign(r,"radius2",t.getRadius2()),t.getPoints&&this.assign(r,"points",t.getPoints()),t.getAngle&&this.assign(r,"angle",t.getAngle()),t.getRotation&&this.assign(r,"rotation",t.getRotation()),t.getOrigin&&this.assign(r,"origin",t.getOrigin()),t.getScale&&this.assign(r,"scale",t.getScale()),t.getSize&&this.assign(r,"size",t.getSize()),t.getAnchor&&(this.assign(r,"anchor",t.getAnchor()),"anchorXUnits,anchorYUnits,anchorOrigin".split(",").forEach(function(e){i.assign(r,e,t[e+"_"])})),t.path&&(t.path&&this.assign(r,"path",t.path),t.getImageSize&&this.assign(r,"imgSize",t.getImageSize()),t.stroke&&this.assign(r,"stroke",t.stroke),t.fill&&this.assign(r,"fill",t.fill),t.scale&&this.assign(r,"scale",t.scale),t.imgSize&&this.assign(r,"imgSize",t.imgSize)),t.getSrc&&this.assign(r,"src",t.getSrc()),r.points&&r.radius!==r.radius2&&(r.points/=2),r):null},e.prototype.serializeColor=function(e){if(e instanceof Array)return{color:l.color.asString(e)};if(e instanceof CanvasGradient)return{gradient:e};if(e instanceof CanvasPattern)return{pattern:e};if("string"==typeof e)return{color:e};throw"unknown color type"},e.prototype.serializeFill=function(e){return this.serializeStyle(e)},e.prototype.deserializeStyle=function(e){var t,i,r,a,n=this;if(e.circle)t=this.deserializeCircle(e.circle);else if(e.star)t=this.deserializeStar(e.star);else if(e.icon)t=this.deserializeIcon(e.icon);else if(e.svg)t=this.deserializeSvg(e.svg);else if(e.image&&(e.image.img||e.image.path))t=this.deserializeSvg(e.image);else if(e.image&&e.image.src)t=this.deserializeIcon(e.image);else if(e.image)throw"unknown image type";e.text&&(i=this.deserializeText(e.text)),e.fill&&(r=this.deserializeFill(e.fill)),e.stroke&&(a=this.deserializeStroke(e.stroke));var o=new l.style.Style({image:t,text:i,fill:r,stroke:a});return t&&o.setGeometry(function(e){return n.setGeometry(e)}),o},e.prototype.deserializeText=function(e){var t;e.rotation=e.rotation||0,e.scale=e.scale||1;var i=[e["offset-x"]||0,e["offset-y"]||0],r=i[0],a=i[1],n=new l.geom.Point([r,a]);return n.rotate(e.rotation,[0,0]),n.scale(e.scale,e.scale),r=(t=n.getCoordinates())[0],a=t[1],new l.style.Text({fill:e.fill&&this.deserializeFill(e.fill),stroke:e.stroke&&this.deserializeStroke(e.stroke),text:e.text,font:e.font,offsetX:r,offsetY:a,rotation:e.rotation,scale:e.scale})},e.prototype.deserializeCircle=function(e){var t=new l.style.Circle({radius:e.radius,fill:e.fill&&this.deserializeFill(e.fill),stroke:e.stroke&&this.deserializeStroke(e.stroke)});return t.setOpacity(e.opacity),t},e.prototype.deserializeStar=function(e){var t=new l.style.RegularShape({radius:e.radius,radius2:e.radius2,points:e.points,angle:e.angle,fill:e.fill&&this.deserializeFill(e.fill),stroke:e.stroke&&this.deserializeStroke(e.stroke)});return i(e.rotation,function(e){return t.setRotation(e)}),i(e.opacity,function(e){return t.setOpacity(e)}),t},e.prototype.deserializeIcon=function(e){e.anchor||(e.anchor=[e["anchor-x"]||.5,e["anchor-y"]||.5]);var t=new l.style.Icon({anchor:e.anchor||[.5,.5],anchorOrigin:e.anchorOrigin||"top-left",anchorXUnits:e.anchorXUnits||"fraction",anchorYUnits:e.anchorYUnits||"fraction",img:void 0,imgSize:void 0,offset:e.offset,offsetOrigin:e.offsetOrigin,opacity:e.opacity,scale:e.scale,snapToPixel:e.snapToPixel,rotateWithView:e.rotateWithView,rotation:e.rotation,size:e.size,src:e.src,color:e.color});return t.load(),t},e.prototype.deserializeSvg=function(t){var e;if(t.rotation=t.rotation||0,t.scale=t.scale||1,t.img){var i=document.getElementById(t.img);if(!i)throw"unable to find svg element: "+t.img;if(i){var r=i.getElementsByTagName("path")[0];r&&(i.viewBox&&(t.imgSize||(t.imgSize=[i.viewBox.baseVal.width,i.viewBox.baseVal.height])),t.path=(t.path||"")+r.getAttribute("d"))}}var a=document.createElement("canvas");if(t.path){if(e=t.imgSize.map(function(e){return e*t.scale}),a.width=e[0],a.height=e[1],t.stroke&&t.stroke.width){var n=2*t.stroke.width*t.scale;a.width+=n,a.height+=n}var o=a.getContext("2d"),s=new Path2D(t.path);o.translate(a.width/2,a.height/2),o.scale(t.scale,t.scale),o.translate(-t.imgSize[0]/2,-t.imgSize[1]/2),t.fill&&(o.fillStyle=t.fill.color,o.fill(s)),t.stroke&&(o.strokeStyle=t.stroke.color,o.lineWidth=t.stroke.width,o.stroke(s))}return p(new l.style.Icon({img:a,imgSize:[a.width,a.height],rotation:t.rotation,scale:1,anchor:t.anchor||[a.width/2,a.height],anchorOrigin:t.anchorOrigin,anchorXUnits:t.anchorXUnits||"pixels",anchorYUnits:t.anchorYUnits||"pixels",offset:t.offset,offsetOrigin:t.offsetOrigin,opacity:t.opacity,snapToPixel:t.snapToPixel,rotateWithView:t.rotateWithView,size:[a.width,a.height],src:void 0}),{path:t.path,stroke:t.stroke,fill:t.fill,scale:t.scale,imgSize:t.imgSize})},e.prototype.deserializeFill=function(e){return new l.style.Fill({color:e&&this.deserializeColor(e)})},e.prototype.deserializeStroke=function(e){var t=new l.style.Stroke;return i(e.color,function(e){return t.setColor(e)}),i(e.lineCap,function(e){return t.setLineCap(e)}),i(e.lineDash,function(e){return t.setLineDash(e)}),i(e.lineJoin,function(e){return t.setLineJoin(e)}),i(e.miterLimit,function(e){return t.setMiterLimit(e)}),i(e.width,function(e){return t.setWidth(e)}),t},e.prototype.deserializeColor=function(e){var t;if(e.color)return e.color;if(e.gradient){var r,i=e.gradient.type;if(0===i.indexOf("linear(")?r=this.deserializeLinearGradient(e.gradient):0===i.indexOf("radial(")&&(r=this.deserializeRadialGradient(e.gradient)),e.gradient.stops){p(r,{stops:e.gradient.stops});var a=e.gradient.stops.split(";");(a=a.map(function(e){return e.trim()})).forEach(function(e){var t=e.match(/ \d+%/m)[0],i=e.substr(0,e.length-t.length);r.addColorStop(parseInt(t)/100,i)})}return r}if(e.pattern){var n=e.pattern.repitition,o=(c=document.createElement("canvas")).width=c.height=6|e.pattern.spacing,s=c.getContext("2d");switch(s.fillStyle=e.pattern.color,e.pattern.orientation){case"horizontal":for(var l=0;l<o;l++)s.fillRect(l,0,1,1);break;case"vertical":for(l=0;l<o;l++)s.fillRect(0,l,1,1);break;case"cross":for(l=0;l<o;l++)s.fillRect(l,0,1,1),s.fillRect(0,l,1,1);break;case"forward":for(l=0;l<o;l++)s.fillRect(l,l,1,1);break;case"backward":for(l=0;l<o;l++)s.fillRect(o-1-l,l,1,1);break;case"diagonal":for(l=0;l<o;l++)s.fillRect(l,l,1,1),s.fillRect(o-1-l,l,1,1)}return p(s.createPattern(c,n),e.pattern)}if(e.image){var c=document.createElement("canvas"),g=(t=e.image.imgSize,c.width=t[0],c.height=t[1],t),f=g[0],h=g[1],d=c.getContext("2d"),u=document.createElement("img");return u.src=e.image.imageData,u.onload=function(){return d.drawImage(u,0,0,f,h)},"rgba(255,255,255,0.1)"}throw"invalid color configuration"},e.prototype.deserializeLinearGradient=function(e){var t=JSON.parse(e.type.replace(/\w+\((.*)\)/m,"[$1]")),i=t[0],r=t[1],a=t[2],n=t[3],o=document.createElement("canvas");o.width=Math.max(i,a),o.height=Math.max(r,n);var s=o.getContext("2d").createLinearGradient(i,r,a,n);return p(s,{type:"linear("+[i,r,a,n].join(",")+")"}),s},e.prototype.deserializeRadialGradient=function(e){var t=JSON.parse(e.type.replace(/radial\((.*)\)/m,"[$1]")),i=t[0],r=t[1],a=t[2],n=t[3],o=t[4],s=t[5],l=document.createElement("canvas");l.width=2*Math.max(i,n),l.height=2*Math.max(r,o);var c=l.getContext("2d").createRadialGradient(i,r,a,n,o,s);return p(c,{type:"radial("+[i,r,a,n,o,s].join(",")+")"}),c},e}();t.StyleConverter=r}),define("index",["require","exports","ol3-symbolizer/format/ol3-symbolizer"],function(e,t,i){"use strict";return i});
//# sourceMappingURL=index.js.map